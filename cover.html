<!DOCTYPE html>
<!-- Displays detailed information on a single cover. Allows OCD metric execution. -->
<html>
    <head>
        <title>OCD - Cover</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="CSS/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="CSS/layout.css">
        <!-- TODO: Possibly omit https: again from the urls before pushing. Though this seems to be best practice now anyways -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
        <script src="JS/bootstrap.min.js"></script>
        <script src="JS/jquery.session.js"></script>
        <script src="JS/contentHandler.js"></script>
        <script src="JS/ServiceAPI/b64.js"></script>
        <script src="JS/ServiceAPI/moduleHelper.js"></script>
        <script src="JS/ServiceAPI/serviceAPI.js"></script>
        <script src="JS/requestHandler.js"></script>
        <script src="JS/coverTableHandler.js"></script>
        <script src="JS/jquery.tablesorter.js"></script>
        <script src="JS/jquery.panzoom.js"></script>
        <script src="JS/jquery.mousewheel.js"></script>
        <script src="JS/force-graph/force-graph.js"></script>
        <script src="JS/force-graph/3d-force-graph.js"></script>
        <script src="JS/arangojs@6.14.1/lib/web.js"></script>
        <script type="text/javascript">
            /* Id of the corresponding graph */
            var graphId = getUrlVar("graphId");
            /* Id of the cover */
            var coverId = getUrlVar("coverId");
            /* Meta Data Xml */
            var coverMetaXml;
            /* Meta Data Xmls of corresponding ground truth candidates (for metric execution) */
            var groundTruthMetasXml;
//            var coverDefaultXml;
            /* Graph structure in JSON format */
            var jsonGraph;
            var have3D;

            /* Database Information */
            var arangoUser = localStorage.getItem("arangoUser@WebOCD");
            var arangoPass = localStorage.getItem("arangoPass@WebOCD");
            var arangoDataBase = localStorage.getItem("arangoDataBase@WebOCD");
            var arangoCollection = localStorage.getItem("arangoCollection@WebOCD");

            //Testserver: http://ocd-web-client.duckdns.org:7071
            //Server ginkgo from rwth: http://192.168.178.20:8529
            const db = new arangojs.Database('http://127.0.0.1:8529');

            /* SVG for Visualization */
            var visualization;
            /* Maximum ground truth candidates (for metric execution) displayed per page */
            var COVERS_PER_PAGE = 20;
            /* Current page of ground truth candidates (for metric execution) */
            var pageNumber = 0;
            /* Default select option value */
            var selectOptionVal = "SELECT";
            /* Default select option code */
            var selectOptionStr = '<option value=' + selectOptionVal + '>--SELECT--</option>';
            /* Metric names */
            var metricNames;
            $(document).ready(function() {
                /* Identifiers for meta information to be displayed */
                var cells = ["Name", "Graph", "CreationMethod", "Communities", "G", "R"];
                /* Requests cover meta information */
                sendRequest("get", "covers/" + coverId + "/graphs/" + graphId + "?outputFormat=META_XML", "",
                    /* Response handler */
                    function(response) {
                        /*
                         * Init meta table
                         */
                        coverMetaXml = response;
                        appendCoverRow($('#coverMetaTable'), coverMetaXml, cells);
                        /*
                        * Init run metric collapsable
                        */
                       $("#metricType").append(
                           selectOptionStr
                           + '<option value="statistical">Statistical Measure</option>'
                           + '<option value="knowledgedriven">Knowledge Driven Measure</option>'
                        );
                        /*
                        * Init metrics table
                        */
                       $(coverMetaXml).find("Metric").each(function() {
                           var name = $(this).find('Type');
                           name = parseEnumName(name.text());
                           var status = $(this).find('Status').text();
                           if(status === 'COMPLETED') {
                               status = '<img class="icon" src="IMG/open-iconic/svg/check.svg" alt="y">';
                           }
                           else {
                               status = '<img class="icon" src="IMG/open-iconic/svg/x.svg" alt="y">';
                           }
                           var value = parseFloat($(this).find('Value').text());
                           value = value.toFixed(4);
                           /* Create table row */
                           var row = '<tr>'
                               + '<td>' + name + '</td>'
                               + '<td>' + status + '</td>'
                               + '<td>' + value + '</td>'
                               + '</tr>';
                           $("#metricsTable tbody").append(row);
                       });
                        /*
                         * Register events/components
                         */
                        registerCoverTable();
                        //registerCollapsable("#metricsCollapsable", metricsCollapsableHandler);
                        registerCollapsable("#metricsCollapsable");
                        registerCollapsable("#visualizationCollapsable", visualizationCollapsableHandler);
                        registerCollapsable("#runMetricCollapsable");
                        registerParameterSelect("#metric", "#metricParameterRow", getMetricParameters);
                    },
                    /* Error handler */
                    function(errorData) {
                        /*
                         * Cover request failed
                         */
                        showConnectionErrorMessage("Cover was not received.");
                    }, "text");
                /*
                 * Submit listener for the run metric form.
                 */
                $('#runMetricForm').submit(function(){
                    if($("#metricType").val() === selectOptionVal) {
                        showErrorMessage('Please select a metric type.');
                        return;
                    }
                    else if($("#metric").val() === selectOptionVal) {
                        showErrorMessage('Please select a metric.');
                        return;
                    }
                    if($("#metricType").val() === "knowledgedriven") {
                        var coverId = $("input[name='coverSelect']:checked").val();
                        if(typeof coverId === 'undefined') {
                            showErrorMessage('Please select a ground truth cover.');
                            return;
                        }
                        /* Request knowledge driven measure execution */
                        else {
                            runKnowledgeDrivenMeasure();
                        }
                    }
                    else if($("#metricType").val() === "statistical") {
                        /* Request statistical measure execution */
                        runStatisticalMeasure();
                    }
                    else {
                        /* Should not happen */
                        showErrorMessage('Client Error.');
                        return;
                    }
                });
                /*
                 * Change listener for the metric type in the run metric form.
                 * Executed when a new metric type is selected.
                 */
                $("#metricType").change(function() {
                    $("#metric").empty();
                    /* Hides ground truth covers */
                    $(".selectorWrapper").css("display", "none");
                    $("#metricType option:selected").each(function() {
                        /* A real metric (i.e. not the default option) is selected */
                        if($(this).val() !== selectOptionVal) {
                            getMetrics(function() {
                                $("#metric").append(selectOptionStr);
                                $(metricNames).find('Name').each(function() {
                                    $("#metric").append(
                                        '<option value="' + $(this).text()
                                        + '">' + parseEnumName($(this).text()) + '</option>');
                                });
                            });
                            if($(this).val() === "knowledgedriven") {
                                /* Displays ground truth covers */
                                loadCoverTable();
                                $(".selectorWrapper").css("display", "block");
                            }
                            else if($(this).val() === "statistical") {
                            }
                            else {
                                showErrorMessage("Client Error");
                            }
                            $("#objectCreatorRow").css("display", "table-row");
                        }
                        else {
                            $("#objectCreatorRow").css("display", "none");
                        }
                    });
                });
            });
            /* Requests the execution of a knowledge driven measure */
            function runKnowledgeDrivenMeasure() {
                var groundTruthId = $("input[name='coverSelect']:checked").val();
                var params = getParameterXml("#metricParams");
                sendRequest("post", "covers/" + coverId + "/graphs/" + graphId +
                        "/metrics/knowledgedriven/groundtruth/"
                        + groundTruthId + "?metricType=" + $('#metric').val(), params,
                        /* Response handler */
                        function(response) {
                            window.location.href = "index.html";
                        },
                        /* Error handler */
                        function(errorData) {
                            /*
                             * Run metric request failed
                             */
                            showConnectionErrorMessage("Metric request failed.");
                        });
            }
            /* Requests the execution of a statistical measure */
            function runStatisticalMeasure() {
                var params = getParameterXml("#metricParams");
                sendRequest("post", "covers/" + coverId + "/graphs/" + graphId
                        + "/metrics/statistical?metricType=" + $('#metric').val()
                        , params,
                        /* Response handler */
                        function(response) {
                            window.location.href = "index.html";
                        },
                        /* Error handler */
                        function(errorData) {
                            /*
                             * Run metric request failed
                             */
                            showConnectionErrorMessage("Metric request failed.");
                        });
            }
            /* Requests and stores the names of the parameters of a given metric
             * Then executes a callback function */
            function getMetricParameters(metricName, callback) {
                sendRequest("get", "metrics/" + metricName + "/parameters/default", "",
                        /* Response handler */
                        function(response) {
                            if(typeof callback !== 'undefined') {
                                callback(response);
                            }
                        },
                        /* Error handler */
                        function(errorData) {
                            /*
                             * GraphIds request failed
                             */
                            showConnectionErrorMessage("Metric parameters were not received.");
                        });
            }
            /* Requests and stores the names of all metrics (of a certain metric type)
             * Then executes a callback function */
            function getMetrics(callback) {
                sendRequest("get", "metrics/" + $("#metricType").val(), "",
                        /* Response handler */
                        function(response) {
                            metricNames = response;
                            if(typeof callback !== 'undefined') {
                                callback();
                            }
                        },
                        /* Error handler */
                        function(errorData) {
                            /*
                             * Request failed
                             */
                            showConnectionErrorMessage("Metric names were not received.");
                        });
            }
            /* Requests a potential ground truth covers and adds them to a table */
            function loadCoverTable() {
                /* Initializes table */
                $('#coverTable tbody').empty();
                $('.pageNumWrapper').empty();
                $('.pageNumWrapper').append(pageNumber);
                var firstIndex = COVERS_PER_PAGE * pageNumber;
                /* Identifiers of the information to be displayed */
                var cells = ["Name", "Graph", "CreationMethod", "Communities", "C", "Select"];
                /* Requests the covers */
                sendRequest("get", "covers?graphId=" + graphId + "&executionStatuses=COMPLETED&includeMeta=TRUE&firstIndex=" + firstIndex + "&length=" + COVERS_PER_PAGE , "",
                    /* Response handler */
                    function(groundTruthMetasXml) {
                        /*
                         * CoverMetas request succeeded
                         */
                        if($(groundTruthMetasXml).find("Id").length === 0 && pageNumber > 0) {
                            pageNumber--;
                            loadCoverTable();
                        }
                        /* Adds each cover to the table */
                        $(groundTruthMetasXml).find("Cover").each(function() {
                            appendCoverRow($('#coverTable'), $(this), cells);
                        });
                            /*
                             * Sort Table
                             */
                            try {
                                $("#coverTable").tablesorter({sortList: [[0,0]],
                                    headers: { 6: {sorter: false}, 7: {sorter: false}}});
                            } catch(err) { /* table empty */ }
                    },
                    /* Error handler */
                    function(errorData) {
                        /*
                         * Ground truth cover request failed
                         */
                        showConnectionErrorMessage("Ground truth cover metas were not received.");
                });
                /* Listener to show the next page of ground truth covers */
                $('.pageLeft').click(function(){
                    if(pageNumber > 0) {
                        pageNumber--;
                        loadCoverTable();
                    }
                });
                /* Listener to show the previous page of ground truth covers */
                $('.pageRight').click(function(){
                    pageNumber++;
                    loadCoverTable();
                });
            }
//            function metricsCollapsableHandler() {
//                if(typeof coverDefaultXml === 'undefined') {
//                    getDefaultXml(function() {
//                            /*
//                             * Init metrics table
//                             */
//                            $(coverDefaultXml).find("Metric").each(function() {
//                                var name = $(this).find('Type');
//                                name = parseEnumName(name.text());
//                                var status = $(this).find('Status').text();
//                                if(status === 'COMPLETED') {
//                                    status = '<img class="icon" src="IMG/open-iconic/svg/check.svg" alt="y">';
//                                }
//                                else {
//                                    status = '<img class="icon" src="IMG/open-iconic/svg/x.svg" alt="y">';
//                                }
//                                var value = parseFloat($(this).find('Value').text());
//                                value = value.toFixed(4);
//                                var row = '<tr>'
//                                    + '<td>' + name + '</td>'
//                                    + '<td>' + status + '</td>'
//                                    + '<td>' + value + '</td>'
//                                    + '</tr>';
//                                $("#metricsTable tbody").append(row);
//                            });
//                        });
//                }
//            }
            /* Requests the default / general information about the cover
             * Then executes a callback function */
            function getDefaultXml(callback) {
                /* Sends a request for the cover information */
                sendRequest("get", "covers/" + coverId + "/graph/" + graphId + "/outputFormat/DEFAULT_XML", "",
                    /* Response handler */
                    function(response) {
                        coverDefaultXml = response;
                        if(typeof callback !== 'undefined') {
                            callback();
                        }
                    },
                    /* Error handler */
                    function(errorData) {
                        /*
                         * GraphIds request failed
                         */
                        showConnectionErrorMessage("Cover was not received.");
                    }, "text");
            }

            /* Handles what happens on the visualization type Button presses */
            function buttonClick(number) {
                $(document).ready(function () {

                    let svgVizScroll = document.getElementById("visualizationZoomer");
                    let svgViz = document.getElementById("visualizationContent");
                    let forceViz = document.getElementById("forceVisualizationContent");

                    highlightNodes = new Set();
                    highlightLinks = new Set();

                    if (number === 0) {
                        forceViz.style.display = "none";
                        if (typeof jsonGraph !== "undefined") {
                            jsonGraph.width($('.forceVisualizationContent').width());
                            jsonGraph.height(800);
                        }
                        svgViz.style.display = "inherit";
                        svgVizScroll.style.display = "inline";
                    } else if (number === 1 || number === 2) {
                        forceViz.style.display = "inherit";
                        if (typeof jsonGraph !== "undefined") {
                            jsonGraph.width($('.forceVisualizationContent').width());
                            jsonGraph.height(800);
                        }
                        svgViz.style.display = "none";
                        svgVizScroll.style.display = "none";

                        if (number === 1 && (have3D === true || typeof have3D === "undefined")) {
                            have3D = false;
                            //console.log("2D");
                            if (typeof jsonGraph !== "undefined") {
                                jsonGraph._destructor();
                            }
                            getJSON();
                        } else if (number === 2 && (have3D === false || typeof have3D === "undefined")) {
                            have3D = true;
                            //console.log("3D");
                            if (typeof jsonGraph !== "undefined") {
                                jsonGraph._destructor();
                            }
                            getJSON();
                        }
                    }
                })
            }

            function databaseInfoSubmit() {
                arangoUser = $("#arangoUser").val();
                arangoPass = $("#arangoPass").val();
                arangoDataBase = $("#arangoDataBase").val();
                arangoCollection = $("#arangoCollection").val();

                localStorage.setItem("arangoUser@WebOCD",arangoUser);
                localStorage.setItem("arangoPass@WebOCD",arangoPass);
                localStorage.setItem("arangoDataBase@WebOCD",arangoDataBase);
                localStorage.setItem("arangoCollection@WebOCD",arangoCollection);
            }

            // Close the dropdown menu if the user clicks outside of it
            window.onclick = function(event) {
                if (!event.target.matches('.dropDownOpenButton') && !event.target.matches('.dataBaseDropDownContentForm')) {
                    var dropdowns = document.getElementsByClassName("dataBaseDropDownContent");
                    var i;
                    for (i = 0; i < dropdowns.length; i++) {
                        var openDropdown = dropdowns[i];
                        if (openDropdown.classList.contains('show')) {
                            openDropdown.classList.remove('show');
                        }
                    }
                }
            }

            /* Requests and stores a JSON representation of the graph.
             * Then executes a callback function */
            function getJSON() {
                //TODO: Change
                sendRequest("get", "visualization/cover/" + coverId + "/graph/"
                    + graphId + "/outputFormat/JSON/layout/ORGANIC/paint/PREDEFINED_COLORS", "",
                    function (response) {
                        jsonGraph = response;
                        //console.log("jsonGRAPH prev: " + jsonGraph)
                        var graph = JSON.parse(jsonGraph);
                        var sizes = new Map();
                        var colors = new Map();
                        for (let node of graph.nodes) {
                            sizes[node.id] = node.size;
                            colors[node.id] = node.color;
                        }

                        if (have3D === false) {
                            jsonGraph = ForceGraph()
                            (document.getElementById('forceVisualizationGraphic'))
                                .graphData(graph)
                                .nodeId('id')
                                .nodeLabel('id')
                                .onNodeClick(node => {
                                    if(arangoDataBase !== "" && arangoDataBase !== null
                                        && arangoUser !== "" && arangoUser !== null
                                        && arangoPass !== null
                                        && arangoCollection !== "" && arangoCollection !== null) {

                                        db.useDatabase(arangoDataBase);
                                        db.useBasicAuth(arangoUser, arangoPass);
                                        const docCollection = db.collection(arangoCollection);
                                        docCollection.document(node.name, true).then(function (doc) {
                                            let nodeWindow = window.open("", '_blank');

                                            if (doc != null) {
                                                //console.log(JSON.stringify(doc, null, '    '));
                                                let docStr = JSON.stringify(doc, null, '    ');
                                                docStr = docStr.replace(/\n/g, "<br />");
                                                nodeWindow.document.write("<pre>" + docStr + "</pre>");
                                            } else {
                                                nodeWindow.document.write("<pre>" + "Object was not found" + "</pre>");
                                            }
                                        }).catch((err) => console.error(err));
                                    }
                                })
                                .nodeVal(function(node) {
                                    return sizes[node.id] - 19
                                })
                                .nodeColor(function (node) {
                                    return colors[node.id];
                                })
                                .onNodeDragEnd(node => {
                                    node.fx = node.x;
                                    node.fy = node.y;
                                })
                                .onNodeRightClick(node => {
                                    //TODO: Seem a bit slow after restoring, check original forces/velocity
                                    node.fx = null;
                                    node.fy = null;
                                })
                                .linkSource('source')
                                .linkDirectionalArrowLength(2)
                                .linkDirectionalArrowRelPos(1)
                                .linkTarget('target')
                                .cooldownTicks(200);
                        } else {
                            jsonGraph = ForceGraph3D()
                            (document.getElementById('forceVisualizationGraphic'))
                                .graphData(graph)
                                .nodeId('id')
                                .nodeLabel('id')
                                .onNodeClick(node => {
                                    if(arangoDataBase !== "" && arangoDataBase !== null
                                        && arangoUser !== "" && arangoUser !== null
                                        && arangoPass !== null
                                        && arangoCollection !== "" && arangoCollection !== null) {

                                        db.useDatabase(arangoDataBase);
                                        db.useBasicAuth(arangoUser, arangoPass);
                                        const docCollection = db.collection(arangoCollection);
                                        docCollection.document(node.name, true).then(function (doc) {
                                            let nodeWindow = window.open("", '_blank');

                                            if (doc != null) {
                                                //console.log(JSON.stringify(doc, null, '    '));
                                                let docStr = JSON.stringify(doc, null, '    ');
                                                docStr = docStr.replace(/\n/g, "<br />");
                                                nodeWindow.document.write("<pre>" + docStr + "</pre>");
                                            } else {
                                                nodeWindow.document.write("<pre>" + "Object was not found" + "</pre>");
                                            }
                                        }).catch((err) => console.error(err));
                                    }
                                })
                                .nodeVal(function(node) {
                                    return sizes[node.id] - 19
                                })
                                .nodeColor(function (node) {
                                    return colors[node.id];
                                })
                                .onNodeDragEnd(node => {
                                    node.fx = node.x;
                                    node.fy = node.y;
                                    node.fz = node.z;
                                })
                                .onNodeRightClick(node => {
                                    //TODO: Seem a bit slow after restoring, check original forces/velocity
                                    node.fx = null;
                                    node.fy = null;
                                    node.fz = null;
                                })
                                .linkSource('source')
                                .linkOpacity(0.35)
                                .linkColor("#dedede")
                                .linkWidth(0)
                                .linkDirectionalArrowLength(2)
                                .linkDirectionalArrowRelPos(1)
                                .linkTarget('target')
                                .cooldownTicks(200);
                        }

                        jsonGraph.width($('.forceVisualizationContent').width());
                        jsonGraph.height(800);
                    },
                    /* Error handler */
                    function (errorData) {
                        /*
                         * GraphIds request failed
                         */
                        showConnectionErrorMessage("Visualization was not received.");
                    });
            }

            /* Handles the collapsable element for the graph visualization */
            function visualizationCollapsableHandler() {
                /* Requests the graph visualization */
                if (typeof visualization === 'undefined') {
                    getVisualization();
                }

                /* Registers the visualization for panzoom */
                var $panzoom = $('body').find('.visualizationGraphic').panzoom({
                    $zoomRange: $('body').find(".visualizationZoomer"),
                    increment: 0.9,
                    contain: 'invert',
                    maxScale: 10,
                    minScale: 1
                });
                $panzoom.on('mousewheel', function (e) {
                    e.preventDefault();
                    var delta = e.delta || e.originalEvent.wheelDelta;
                    var zoomOut = delta ? delta < 0 : e.originalEvent.deltaY > 0;
                    $panzoom.panzoom('zoom', zoomOut, {
                        increment: 0.1,
                        animate: false,
                        focal: e
                    });
                });
            }
            /* Requests and stores the visualization of the cover */
            function getVisualization() {
                /* Requests the visualization */
                sendRequest("get", "visualization/cover/" + coverId + "/graph/"
                        + graphId + "/outputFormat/SVG/layout/ORGANIC/paint/PREDEFINED_COLORS", "",
                    /* Response handler */
                    function(response) {
                        visualization = response;
                        $('.visualizationGraphic').append(visualization);
                    },
                    /* Error handler */
                    function(errorData) {
                        /*
                         * Visualization request failed
                         */
                        showConnectionErrorMessage("Visualization was not received.");
                });
            }
        </script>
    </head>
    <body>
        <div id="wrapper">
            <div id="contentWrapper">
                <div id="content">
                    <!-- Container for display of error messages -->
                    <div id="errorMessageWrapper">
                        <div id="errorMessage"></div>
                    </div>

                    <!-- Cover meta information table -->
                    <div id="coverHeader" class="col-sm-12 col-md-12 coverColor">

                    </div>

                    <div class="tableWrapper">
                        <table id="coverMetaTable">
                            <thead>
                            <tr>
                                <th class="hidden" title="CoverId"></th>
                                <th class="hidden" title="GraphId"></th>
                                <th width="300" title="Cover Name" class="sortable">
                                    Name
                                    <img class="icon iconBtn" src="IMG/open-iconic/svg/sort-ascending.svg" alt="d">
                                </th>
                                <th width="300" title="Graph Name" class="sortable">
                                    Graph
                                    <img class="icon iconBtn" src="IMG/open-iconic/svg/sort-ascending.svg" alt="d">
                                </th>
                                <th width="300" title="Algorithm Name" class="sortable">
                                    Creation Method
                                    <img class="icon iconBtn" src="IMG/open-iconic/svg/sort-ascending.svg" alt="d">
                                </th>
                                <th width="100" title="Community Count" class="sortable">
                                    Communities
                                    <img class="icon iconBtn" src="IMG/open-iconic/svg/sort-ascending.svg" alt="d">
                                </th>
                                <th width="20" title="Show Graph">
                                    G
                                </th>
                                <th width="20" title="Remove Cover">
                                    R
                                </th>
                            </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <!-- Collapsable element for metric value display -->
                    <div id="metricsCollapsable" class="collapsable">
                        <div class="collapsableHeader">
                            <div class="collapsableTitle">Metrics</div>
                            <div class="collapsableCollapser">
                                <img class="icon iconBtn collapsableDisplayBtn" src="IMG/open-iconic/svg/chevron-bottom.svg" alt="d">
                                <img class="icon iconBtn collapsableCollapseBtn" src="IMG/open-iconic/svg/chevron-top.svg" alt="c">
                            </div>
                        </div>
                        <div class="collapsableContent">
                            <div class="tableWrapper table-responsive">
                                <table id="metricsTable" class="table">
                                    <thead>
                                    <tr>
                                        <th title="Metric Name">
                                            Metric
                                        </th>
                                        <th width="20" title="Completed">
                                            Completed
                                        </th>
                                        <th title="Metric Value">
                                            Value
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- Collapsable element for metric execution -->
                    <div id="runMetricCollapsable" class="collapsable">
                        <div class="collapsableHeader">
                            <div class="collapsableTitle">Run Metric</div>
                            <div class="collapsableCollapser">
                                <img class="icon iconBtn collapsableDisplayBtn" src="IMG/open-iconic/svg/chevron-bottom.svg" alt="d">
                                <img class="icon iconBtn collapsableCollapseBtn" src="IMG/open-iconic/svg/chevron-top.svg" alt="c">
                            </div>
                        </div>
                        <div class="collapsableContent">
                            <div class="formWrapper">
                                <div class="formDiv">
                                    <form id="runMetricForm" class="parameterized" action="javascript:void(0); return false;">
                                        <div class="formContentWrapper">
                                            <table class="formTable">
                                                <tr>
                                                    <td>
                                                        Metric Type:
                                                    </td>
                                                    <td>
                                                        <select id="metricType" class="nonparameter">
                                                        </select>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        Metric:
                                                    </td>
                                                    <td>
                                                        <select id="metric" class="nonparameter">
                                                        </select>
                                                    </td>
                                                </tr>
                                                <tr id="metricParameterRow" class="hidden">
                                                    <td>
                                                        Parameters:
                                                    </td>
                                                    <td>
                                                        <div class="tableWrapper">
                                                            <table id="metricParams">
                                                                <thead>
                                                                    <tr>
                                                                        <th title="Parameter Name">Name</th>
                                                                        <th title="Default Value">Default</th>
                                                                        <th title="Use Non-Default Parameter">Value</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody></tbody>
                                                            </table>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                        <div class="submitWrapper">
                                            <input name="submit" id="runMetricBtn" class="submit icon" type="image" src="IMG/open-iconic/svg/media-play.svg" alt="Run">
                                        </div>
                                        <div class="selectorWrapper hidden">
                                        <div class="selectorTitle">
                                            Select a Ground Truth Cover
                                        </div>
                                        <div class="selectorContent">
                                            <!-- Page control for ground truth cover table -->
                                            <div class = "pageControlWrapper">
                                                <div class="pageControl">
                                                    <div class="pageLeftWrapper">
                                                        <img class="icon iconBtn pageLeft" src="IMG/open-iconic/svg/chevron-left.svg" alt="r">
                                                    </div>
                                                    <div class = "pageNumWrapper">
                                                    </div>
                                                    <div class="pageRightWrapper">
                                                        <img class="icon iconBtn pageRight" src="IMG/open-iconic/svg/chevron-right.svg" alt="r">
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- Table for potential ground truth covers -->
                                            <div class="tableWrapper">
                                                <table id="coverTable">
                                                    <thead>
                                                    <tr>
                                                        <th class="hidden" title="CoverId"></th>
                                                        <th class="hidden" title="GraphId"></th>
                                                        <th width="300" title="Cover Name" class="sortable">
                                                            Name
                                                            <img class="icon iconBtn" src="IMG/open-iconic/svg/sort-ascending.svg" alt="d">
                                                        </th>
                                                        <th width="300" title="Graph Name" class="sortable">
                                                            Graph
                                                            <img class="icon iconBtn" src="IMG/open-iconic/svg/sort-ascending.svg" alt="d">
                                                        </th>
                                                        <th width="300" title="Algorithm Name" class="sortable">
                                                            Creation Method
                                                            <img class="icon iconBtn" src="IMG/open-iconic/svg/sort-ascending.svg" alt="d">
                                                        </th>
                                                        <th width="100" title="Community Count" class="sortable">
                                                            Communities
                                                            <img class="icon iconBtn" src="IMG/open-iconic/svg/sort-ascending.svg" alt="d">
                                                        </th>
                                                        <th width="20" title="Show Cover">
                                                            C
                                                        </th>
                                                        <th width="20" title="Select Graph">
                                                            Select
                                                        </th>
                                                    </tr>
                                                    </thead>
                                                    <tbody></tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Collapsable for cover visualization -->
                    <div id="visualizationCollapsable" class="collapsable">
                        <div class="collapsableHeader">
                            <div class="collapsableTitle">Visualization</div>
                            <div class="collapsableCollapser">
                                <img class="icon iconBtn collapsableDisplayBtn" src="IMG/open-iconic/svg/chevron-bottom.svg" alt="d">
                                <img class="icon iconBtn collapsableCollapseBtn" src="IMG/open-iconic/svg/chevron-top.svg" alt="c">
                            </div>
                        </div>
                        <div class="collapsableContent">
                            <div class="optionRow" style="width:100%">
                                <div class="dataBaseDropDown" style="width:19%">
                                    <button class="dropDownOpenButton" onclick="databaseInfoDropDown()">Database</button>
                                    <form method="post" id="dataBaseDropDownContent" class="dataBaseDropDownContent">
                                        <input class="dataBaseDropDownContentForm" id="arangoUser" type="text" name="arangoUser" placeholder="User">
                                        <input class="dataBaseDropDownContentForm" id="arangoPass" type="text" name="arangoPass" placeholder="Password">
                                        <input class="dataBaseDropDownContentForm" id="arangoDataBase" type="text" name="arangoDataBase" placeholder="Database">
                                        <input class="dataBaseDropDownContentForm" id="arangoCollection" type="text" name="arangoCollection" placeholder="Collection">
                                        <button class="dropDownCloseButton" onclick="databaseInfoSubmit()">Save</button>
                                    </form>
                                </div>
                                <div class="btn-group" style="width:80%">
                                    <button onclick="buttonClick(0)" style="width:33.3%">SVG</button>
                                    <button onclick="buttonClick(1)" style="width:33.3%">2D Interactive</button>
                                    <button onclick="buttonClick(2)" style="width:33.3%">3D Interactive</button>
                                </div>
                            </div>
                            <!-- Container for graph visualization -->
                            <div class="visualization">
                                <div class="visualizationControl" id="visualizationControl">
                                    <input id="visualizationZoomer" class="visualizationZoomer" type="range">
                                </div>
                                <div id="visualizationContent" class="visualizationContent">
                                    <div class="visualizationGraphic"></div>
                                </div>
                                <div id="forceVisualizationContent" class="forceVisualizationContent">
                                    <div id="forceVisualizationGraphic" class="forceVisualizationGraphic"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
